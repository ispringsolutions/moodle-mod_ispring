define("mod_ispring/api",["exports","core/ajax"],(function(_exports,_ajax){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   *
   * @class       mod_ispring/api
   * @copyright   2023 iSpring Solutions Inc.
   * @author      Desktop Team <desktop-team@ispring.com>
   * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
class Api{constructor(sessionId,contentId,returnUrl){this._sessionId=sessionId,this._contentId=contentId,this._returnUrl=returnUrl}startSession(state){(0,_ajax.call)([{methodname:"mod_ispring_start_session",args:{content_id:this._contentId,state:JSON.stringify(state)}}])[0].then((result=>{this._sessionId=result.session_id})).catch((()=>{}))}setState(state){(0,_ajax.call)([{methodname:"mod_ispring_set_state",args:{session_id:this._sessionId,state:JSON.stringify(state)}}])[0].then((()=>{})).catch((()=>{}))}endSession(state){(0,_ajax.call)([{methodname:"mod_ispring_end_session",args:{session_id:this._sessionId,state:JSON.stringify(state)}}])[0].then((()=>{})).catch((()=>{}))}terminate(){window.location.replace(this._returnUrl)}}_exports.init=(contentId,playerUrl,iframeId,returnUrl)=>{window.ispring_moodle_connector=new Api(0,contentId,returnUrl),(0,_ajax.call)([{methodname:"mod_ispring_get_player_data",args:{content_id:contentId}}])[0].then((result=>{var persistStateId,persistState;persistStateId=result.persist_state_id,persistState=result.persist_state,localStorage&&persistStateId&&(persistState?localStorage.setItem(persistStateId,persistState):localStorage.removeItem(persistStateId))})).catch((()=>{})).then((()=>{document.getElementById(iframeId).src=playerUrl}))}}));

//# sourceMappingURL=api.min.js.map